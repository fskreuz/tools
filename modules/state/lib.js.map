{"version":3,"file":"lib.js","sources":["modules/state/lib.js"],"sourcesContent":["const defaultEffect = () => { }\nconst defaultReduce = s => s\nconst defaultView = () => null\nconst defaultRender = () => { }\n\nexport const Action = {\n  Init: 'ACTION_INIT',\n  UncaughtError: 'ACTION_UNCAUGHT_ERROR'\n}\n\nexport const createApp = ({ effect = defaultEffect, reduce = defaultReduce, view = defaultView, render = defaultRender }) => {\n  let root, state\n\n  const dispatch = (type, payload = null) => {\n    const action = { type, payload }\n\n    try {\n      effect(state, action, (...args) => setTimeout(() => dispatch(...args)))\n      const newState = reduce(state, action)\n\n      if (state === newState) return\n\n      state = newState\n      root = render(view({ state, dispatch }), root)\n    } catch (error) {\n      setTimeout(() => dispatch(Action.UncaughtError, error))\n    }\n  }\n\n  setTimeout(() => dispatch(Action.Init, Date.now()))\n\n  return dispatch\n}\n\nexport const combineReducers = reducerMap => (state = {}, action) => {\n  return Object.entries(reducerMap).reduce((c, [key, reducer]) => {\n    const result = reducer(c[key], action)\n\n    return state[key] === result ? c : { ...c, [key]: result }\n  }, state)\n}\n\nexport const combineEffects = effects => (...args) => {\n  effects.forEach(e => e(...args))\n}\n\nexport const combineRenderers = renderers => (...args) => {\n  renderers.forEach(r => r(...args))\n}\n"],"names":["defaultEffect","defaultReduce","s","defaultView","defaultRender","Action","Init","UncaughtError","createApp","effect","reduce","view","render","root","state","dispatch","type","payload","action","args","setTimeout","newState","error","Date","now","combineReducers","reducerMap","Object","entries","c","key","reducer","result","combineEffects","effects","forEach","e","combineRenderers","renderers","r"],"mappings":"AAAA,MAAMA,EAAgB,OAChBC,EAAgBC,GAAKA,EACrBC,EAAc,IAAM,KACpBC,EAAgB,OAETC,EAAS,CACpBC,KAAM,cACNC,cAAe,yBAGJC,EAAY,EAAGC,OAAAA,EAAST,EAAeU,OAAAA,EAAST,EAAeU,KAAAA,EAAOR,EAAaS,OAAAA,EAASR,MACvG,IAAIS,EAAMC,EAEV,MAAMC,EAAW,CAACC,EAAMC,EAAU,QAChC,MAAMC,EAAS,CAAEF,KAAAA,EAAMC,QAAAA,GAEvB,IACER,EAAOK,EAAOI,GAAQ,IAAIC,IAASC,YAAW,IAAML,KAAYI,OAChE,MAAME,EAAWX,EAAOI,EAAOI,GAE/B,GAAIJ,IAAUO,EAAU,OAExBP,EAAQO,EACRR,EAAOD,EAAOD,EAAK,CAAEG,MAAAA,EAAOC,SAAAA,IAAaF,GACzC,MAAOS,GACPF,YAAW,IAAML,EAASV,EAAOE,cAAee,OAMpD,OAFAF,YAAW,IAAML,EAASV,EAAOC,KAAMiB,KAAKC,SAErCT,GAGIU,EAAkBC,GAAc,CAACZ,EAAQ,GAAII,IACjDS,OAAOC,QAAQF,GAAYhB,QAAO,CAACmB,GAAIC,EAAKC,MACjD,MAAMC,EAASD,EAAQF,EAAEC,GAAMZ,GAE/B,OAAOJ,EAAMgB,KAASE,EAASH,EAAI,IAAKA,EAAGC,CAACA,GAAME,KACjDlB,GAGQmB,EAAiBC,GAAW,IAAIf,KAC3Ce,EAAQC,SAAQC,GAAKA,KAAKjB,MAGfkB,EAAmBC,GAAa,IAAInB,KAC/CmB,EAAUH,SAAQI,GAAKA,KAAKpB"}